(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7874:function(e,s,a){Promise.resolve().then(a.bind(a,361))},361:function(e,s,a){"use strict";a.d(s,{default:function(){return R}});var t=a(7437),l=a(2265),r=a(9501),n=a(3590),c=a(7119),i=a(1713),d=a(4438),o=a(7689),m=a(5863),u=a(1317);let x=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 ".concat(a),children:s})},h=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"px-6 py-4 ".concat(a),children:s})},p=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"text-lg font-semibold ".concat(a),children:s})},f=e=>{let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"px-6 pb-6 ".concat(a),children:s})},g=l.forwardRef((e,s)=>{let{className:a="",...l}=e;return(0,t.jsx)("input",{className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 ".concat(a),ref:s,...l})});g.displayName="Input";var y=a(875);let j=e=>{let{value:s,onValueChange:a,disabled:r=!1,children:n}=e,[c,i]=(0,l.useState)(!1),d=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,t.jsx)("div",{ref:d,className:"relative",children:l.Children.map(n,e=>{if(l.isValidElement(e)){if(e.type===b)return l.cloneElement(e,{onClick:()=>!r&&i(!c),disabled:r,isOpen:c});if(e.type===N&&c)return l.cloneElement(e,{onItemSelect:e=>{null==a||a(e),i(!1)},selectedValue:s})}return null})})},b=e=>{let{className:s="",children:a,onClick:l,disabled:r,isOpen:n}=e;return(0,t.jsxs)("button",{type:"button",className:"w-full px-3 py-2 text-left bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 disabled:bg-gray-100 disabled:cursor-not-allowed flex items-center justify-between ".concat(s),onClick:l,disabled:r,children:[a,(0,t.jsx)(y.Z,{className:"h-4 w-4 text-gray-400 transition-transform ".concat(n?"rotate-180":"")})]})},N=e=>{let{children:s,onItemSelect:a,selectedValue:r}=e;return(0,t.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:l.Children.map(s,e=>l.isValidElement(e)&&e.type===v?l.cloneElement(e,{onSelect:a,isSelected:e.props.value===r}):e)})},v=e=>{let{value:s,children:a,onSelect:l,isSelected:r}=e;return(0,t.jsx)("div",{className:"px-3 py-2 cursor-pointer hover:bg-emerald-50 ".concat(r?"bg-emerald-100 text-emerald-900":"text-gray-900"),onClick:()=>null==l?void 0:l(s),children:a})},_=e=>{let{placeholder:s}=e;return(0,t.jsx)("span",{className:"text-gray-500",children:s})},w=l.forwardRef((e,s)=>{let{variant:a="default",size:l="md",className:r="",children:n,...c}=e;return(0,t.jsx)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none"," ").concat({default:"bg-emerald-600 text-white hover:bg-emerald-700",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",ghost:"text-gray-700 hover:bg-gray-100"}[a]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[l]," ").concat(r),ref:s,...c,children:n})});w.displayName="Button";let S=l.forwardRef((e,s)=>{let{className:a="",...l}=e;return(0,t.jsx)("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 min-h-[100px] resize-y ".concat(a),ref:s,...l})});S.displayName="Textarea";let C=e=>{let{id:s,checked:a=!1,onCheckedChange:l,disabled:r=!1,className:n=""}=e;return(0,t.jsx)("input",{type:"checkbox",id:s,checked:a,onChange:e=>null==l?void 0:l(e.target.checked),disabled:r,className:"h-4 w-4 text-emerald-600 focus:ring-emerald-500 border-gray-300 rounded ".concat(n)})},k=e=>{let{className:s="",children:a,...l}=e;return(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700 ".concat(s),...l,children:a})};var Z=a(407),A=a(3464);let E=e=>{let s=A.Z.create({baseURL:e.apiUrl,headers:{"Content-Type":"application/json",...e.apiHeaders}});return{axiosInstance:s,fetchCountries:async()=>{let e=await s.get("/global/country/"),a=e.data.find(e=>"United States"===e.name),t=e.data.filter(e=>"United States"!==e.name);return a?[a,...t]:e.data},fetchStates:async e=>(await s.get("/global/state/?country=".concat(e))).data,fetchCities:async e=>(await s.get("/global/city/?state=".concat(e))).data,getAllProgrammes:async()=>(await s.get("/global/programme/")).data,getSchemesByProgramme:async e=>(await s.get("/global/scheme/?programme=".concat(e))).data,submitForm:async e=>await s.post("/company/auditor/create/",e,{headers:{"Content-Type":"multipart/form-data"}})}};var P=e=>{let{selectedPrograms:s,selectedSchemes:a={},setSelectedPrograms:r,setSelectedSchemes:n,setSelectedSchemesList:c,apiConfig:d}=e,[o,u]=(0,l.useState)([]),[g,j]=(0,l.useState)({}),{getAllProgrammes:b,getSchemesByProgramme:N}=E(d),{data:v=[],isLoading:_}=(0,i.a)({queryKey:["programmes"],queryFn:b}),S=async e=>{try{let s=await N(e);return j(a=>({...a,[e]:s})),s}catch(s){return console.error("Error fetching schemes for program ".concat(e,":"),s),[]}};l.useEffect(()=>{s.forEach(e=>{g[e]||S(e)})},[s]);let A=e=>{u(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},P=async e=>{s.includes(e)?(r(s=>s.filter(s=>s!==e)),n(s=>{let a={...s};return delete a[e],a}),c(s=>{let a=(g[e]||[]).map(e=>e.id);return s.filter(e=>!a.includes(e))}),u(s=>s.filter(s=>s!==e))):(r(s=>[...s,e]),g[e]||await S(e))},F=(e,s)=>{var t;return!!a&&!!(null===(t=a[e])||void 0===t?void 0:t.includes(s))},q=e=>{let s=(g[e]||[]).map(e=>e.id),t=a[e]||[];s.length>0&&s.every(e=>t.includes(e))?(n(s=>{let a={...s};return delete a[e],a}),c(e=>e.filter(e=>!s.includes(e)))):(n(a=>({...a,[e]:s})),c(e=>{let a=[...e];return s.forEach(e=>{a.includes(e)||a.push(e)}),a}))},L=(e,s)=>{n(a=>{let t=a[e]||[],l=t.includes(s),r=l?t.filter(e=>e!==s):[...t,s];return c(e=>l?e.filter(e=>e!==s):[...e,s]),{...a,[e]:r.length>0?r:void 0}})};return _?(0,t.jsx)(x,{className:"mb-5",children:(0,t.jsxs)(f,{className:"p-4 flex justify-center items-center h-40",children:[(0,t.jsx)(m.Z,{className:"h-6 w-6 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"Loading programmes..."})]})}):(0,t.jsxs)(x,{className:"mb-5",children:[(0,t.jsx)(h,{className:"border-b",children:(0,t.jsx)(p,{children:(0,t.jsxs)("h3",{className:"font-bold text-lg",children:["Apply for",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]})})}),(0,t.jsx)(f,{className:"p-4",children:(0,t.jsx)("div",{className:"space-y-2",children:v.map(e=>{let a=g[e.id]||[],l=o.includes(e.id),r=s.includes(e.id),n=a.length>0&&a.every(s=>F(e.id,s.id));return(0,t.jsxs)("div",{className:"border rounded-md",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(w,{type:"button",variant:"ghost",size:"sm",onClick:()=>A(e.id),children:l||r?(0,t.jsx)(y.Z,{className:"h-4 w-4"}):(0,t.jsx)(Z.Z,{className:"h-4 w-4"})}),(0,t.jsx)(C,{id:"program-".concat(e.id),checked:r,onCheckedChange:()=>P(e.id)}),(0,t.jsx)(k,{htmlFor:"program-".concat(e.id),className:"text-sm font-medium",children:e.name})]}),r&&a.length>0&&(0,t.jsx)(w,{type:"button",variant:"outline",size:"sm",onClick:()=>q(e.id),children:n?"Deselect All":"Select All"})]}),(l||r)&&(0,t.jsx)("div",{className:"p-3 pl-6 space-y-3",children:r&&0===a.length?(0,t.jsxs)("div",{className:"flex justify-center items-center py-2",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 animate-spin mr-2"}),(0,t.jsx)("span",{className:"text-sm",children:"Loading schemes..."})]}):0===a.length?(0,t.jsx)("div",{className:"text-sm text-gray-500 italic",children:"No schemes available for this program"}):a.map(s=>{let a=F(e.id,s.id);return(0,t.jsx)("div",{className:"border rounded-md",children:(0,t.jsx)("div",{className:"flex items-center justify-between p-4 bg-gray-50",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(C,{className:"ml-4",id:"scheme-".concat(s.id),checked:a,onCheckedChange:()=>L(e.id,s.id)}),(0,t.jsx)(k,{htmlFor:"scheme-".concat(s.id),className:"text-sm",children:s.name})]})})},s.id)})})]},e.id)})})})]})};let F=async(e,s)=>{if(s&&e)try{await A.Z.put(e,s,{headers:{"Content-Type":s.type}})}catch(e){throw console.error("Error uploading image:",e),e}},q=e=>{let s=new FormData;return Object.keys(e).forEach(a=>{let t=e[a];null!=t&&""!==t&&(t instanceof File?s.append(a,t):s.append(a,String(t)))}),s},L=c.Ry({first_name:c.Z_().min(1,"First name is required"),last_name:c.Z_().optional(),email:c.Z_().email({message:"Please enter a valid email address."}),phone_number:c.Z_().min(5,{message:"Phone number must be valid."}),company:c.Z_().min(2,{message:"Company name must be at least 2 characters."}),country_id:c.Z_().min(1,{message:"Please select a country."}),state_id:c.Z_().optional(),city_id:c.Z_().optional(),address:c.Z_().optional(),pincode:c.Z_().optional(),message:c.Z_().optional(),resume:c.Yj().nullable().optional(),file_name:c.Z_().optional(),file_type:c.Z_().optional()});var R=()=>{let[e,s]=(0,l.useState)(!1),[a,c]=(0,l.useState)(null),[y,C]=(0,l.useState)(""),[k,Z]=(0,l.useState)(""),A=(0,l.useRef)(null),[R,T]=(0,l.useState)([]),[U,V]=(0,l.useState)([]),[I,K]=(0,l.useState)({}),z={apiUrl:"https://crmapi.thinkdatalabs.com/api",apiHeaders:{"x-access-api-key":"c8020ac4ad9745fa6e0a8deaccc4ba5c525f58dbf85a01de9dc0f50c9e1a15ae","x-public-api-key":"282af17a9b504ce038cd37cc6e91127b"}},{fetchCountries:H,fetchStates:Q,fetchCities:B,submitForm:O}=E(z),{register:D,handleSubmit:X,control:W,formState:{errors:Y,isSubmitting:G},setValue:J,watch:M,reset:$}=(0,r.cI)({resolver:(0,n.F)(L),defaultValues:{first_name:"",last_name:"",email:"",company:"",phone_number:"",country_id:"",state_id:"",city_id:"",address:"",pincode:"",message:"",resume:null}}),ee=M("resume"),{data:es=[],isLoading:ea}=(0,i.a)({queryKey:["countries"],queryFn:H,staleTime:3e5}),{data:et=[]}=(0,i.a)({queryKey:["states",y],queryFn:()=>Q(y),enabled:!!y}),{data:el=[]}=(0,i.a)({queryKey:["cities",k],queryFn:()=>B(k),enabled:!!k}),er=e=>{C(e),J("country_id",e),J("state_id",""),J("city_id",""),Z("")},en=e=>{Z(e),J("state_id",e),J("city_id","")},ec=e=>{J("city_id",e)},ei=async e=>{var t,l,r,n,i;if(!a){d.Am.error("Please complete the CAPTCHA.");return}try{s(!0);let{resume:a,first_name:n,last_name:i,...o}=e,m=q({...o,full_name:"".concat(e.first_name," ").concat(e.last_name).trim()});(R||[]).forEach(e=>{m.append("programmes",String(e))}),(U||[]).forEach(e=>{m.append("schemes",String(e))});let u=await O(m);(201===u.status||200===u.status)&&(d.Am.success("Application Submitted successfully."),$(),(null==u?void 0:null===(l=u.data)||void 0===l?void 0:null===(t=l.pre_signed)||void 0===t?void 0:t.presigned_url)&&await F(null==u?void 0:null===(r=u.data)||void 0===r?void 0:r.pre_signed.presigned_url,a),T([]),V([]),K({}),c(null),C(""),Z(""),window.scrollTo(0,0))}catch(e){console.error("Submission error:",e),(null===(n=e.response)||void 0===n?void 0:n.status)===400?d.Am.error("Invalid form data."):(null===(i=e.response)||void 0===i?void 0:i.status)===409?d.Am.error("Email already exists."):d.Am.error("An error occurred. Please try again later.")}finally{s(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-emerald-50",style:{backgroundColor:"#f0fdf7"},children:(0,t.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,t.jsx)("h2",{className:"flex justify-center items-center text-emerald-600 pt-12 pb-8 text-3xl uppercase font-extrabold drop-shadow-sm",style:{color:"#059669"},children:"Auditor Application Form"}),(0,t.jsxs)("form",{onSubmit:X(ei),className:"space-y-6",children:[(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{className:"border-b border-border mb-6",children:(0,t.jsx)(p,{children:(0,t.jsxs)("h3",{className:"font-bold text-lg",children:["Personal Info",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]})})}),(0,t.jsxs)(f,{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(g,{placeholder:"First Name",...D("first_name")}),Y.first_name&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.first_name.message})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(g,{placeholder:"Last Name",...D("last_name")}),Y.last_name&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.last_name.message})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(g,{placeholder:"Email",type:"email",...D("email")}),Y.email&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.email.message})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(g,{placeholder:"Phone",...D("phone_number")}),Y.phone_number&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.phone_number.message})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(g,{placeholder:"Company",...D("company")}),Y.company&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.company.message})]}),(0,t.jsx)(r.Qr,{name:"country_id",control:W,render:e=>{let{field:s}=e;return(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsxs)(j,{value:s.value,onValueChange:er,children:[(0,t.jsx)(b,{className:"text-gray-400",children:(0,t.jsx)(_,{placeholder:ea?"Loading...":"Select Country"})}),(0,t.jsx)(N,{children:es.map(e=>(0,t.jsx)(v,{value:e.id,children:e.name},e.id))})]})})}}),(0,t.jsx)(r.Qr,{name:"state_id",control:W,render:e=>{let{field:s}=e;return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)(j,{value:s.value,onValueChange:en,disabled:!y,children:[(0,t.jsx)(b,{className:"text-gray-400",children:(0,t.jsx)(_,{placeholder:y?"Select State":"Select Country First"})}),(0,t.jsx)(N,{children:et.map(e=>(0,t.jsx)(v,{value:e.id,children:e.name},e.id))})]}),Y.state_id&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.state_id.message})]})}}),(0,t.jsx)(r.Qr,{name:"city_id",control:W,render:e=>{let{field:s}=e;return(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)(j,{value:s.value,onValueChange:ec,disabled:!k,children:[(0,t.jsx)(b,{className:"text-gray-400",children:(0,t.jsx)(_,{placeholder:k?"Select City":"Select State First"})}),(0,t.jsx)(N,{children:el.map(e=>(0,t.jsx)(v,{value:e.id,children:e.name},e.id))})]}),Y.city_id&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.city_id.message})]})}}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(g,{placeholder:"Pincode",...D("pincode")}),Y.pincode&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.pincode.message})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("input",{type:"file",ref:A,onChange:e=>{if(e.target.files&&e.target.files.length>0){let s=e.target.files[0];J("resume",s),J("file_name",s.name),J("file_type",s.type)}},className:"hidden",accept:".pdf,.doc,.docx"}),(0,t.jsxs)(w,{type:"button",variant:"outline",onClick:()=>{A.current&&A.current.click()},className:"text-left",children:[(0,t.jsx)(o.Z,{className:"mr-2 h-4 w-4"}),ee&&"string"!=typeof ee?ee.name:"Upload Resume"]})]}),(0,t.jsxs)("div",{className:"flex flex-col md:col-span-2",children:[(0,t.jsx)(S,{placeholder:"Address",...D("address")}),Y.address&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.address.message})]})]})]}),(0,t.jsx)(P,{selectedPrograms:R,selectedSchemes:I,setSelectedPrograms:T,setSelectedSchemes:K,setSelectedSchemesList:V,apiConfig:z}),(0,t.jsxs)(x,{children:[(0,t.jsx)(h,{className:"border-b border-border mb-6",children:(0,t.jsx)(p,{children:(0,t.jsx)("h3",{className:"font-bold text-lg",children:"Remarks"})})}),(0,t.jsx)(f,{children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)(S,{placeholder:"Remarks",...D("message")}),Y.message&&(0,t.jsx)("span",{className:"text-red-500 text-sm mt-1",children:Y.message.message})]})})]}),(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-4",children:[(0,t.jsx)(u.Z,{sitekey:"6LcKXbIqAAAAAPhuxH6QqcXURTo77hkvyWP10Bdf",onChange:e=>c(e)}),(0,t.jsx)(w,{className:"ml-auto",type:"submit",disabled:e||G,style:{backgroundColor:"#059669"},children:e?(0,t.jsx)(m.Z,{className:"animate-spin mr-2"}):"Submit"})]})]})]})})}}},function(e){e.O(0,[520,75,971,117,744],function(){return e(e.s=7874)}),_N_E=e.O()}]);